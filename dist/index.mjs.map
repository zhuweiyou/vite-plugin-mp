{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { Plugin, mergeConfig, splitVendorChunkPlugin } from 'vite'\r\nimport { resolve } from 'path'\r\nimport glob from 'glob'\r\n\r\nconst r = (p: string) => resolve(process.cwd(), p)\r\n\r\nexport function ViteMpPlugin(): Plugin {\r\n  return {\r\n    name: 'vite-plugin-mp',\r\n    config: userConfig => {\r\n      const newConfig = mergeConfig(\r\n        {\r\n          root: 'src',\r\n          resolve: {\r\n            alias: {\r\n              '@': r('src'),\r\n              src: r('src'),\r\n            },\r\n          },\r\n          publicDir: r('public'),\r\n          build: {\r\n            emptyOutDir: true,\r\n            outDir: r('dist'),\r\n            rollupOptions: {\r\n              input: glob.sync('src/**/*.html').reduce(\r\n                (obj, file) => ({\r\n                  ...obj,\r\n                  [file\r\n                    .split('/')\r\n                    .slice(1)\r\n                    .join('.')\r\n                    .replace(/(\\.index)?\\.html$/, '')]: file,\r\n                }),\r\n                {}\r\n              ),\r\n            },\r\n          },\r\n        },\r\n        userConfig\r\n      )\r\n      if (!newConfig.plugins) {\r\n        newConfig.plugins = []\r\n      }\r\n      newConfig.plugins.push(splitVendorChunkPlugin())\r\n      return newConfig\r\n    },\r\n  }\r\n}\r\n\r\nexport default ViteMpPlugin\r\n"],"mappings":"6aAAA,+DACA,+BACA,oBAEA,GAAM,GAAI,AAAC,GAAc,EAAQ,QAAQ,IAAI,EAAG,CAAC,EAE1C,YAAgC,CACrC,MAAO,CACL,KAAM,iBACN,OAAQ,GAAc,CACpB,GAAM,GAAY,EAChB,CACE,KAAM,MACN,QAAS,CACP,MAAO,CACL,IAAK,EAAE,KAAK,EACZ,IAAK,EAAE,KAAK,CACd,CACF,EACA,UAAW,EAAE,QAAQ,EACrB,MAAO,CACL,YAAa,GACb,OAAQ,EAAE,MAAM,EAChB,cAAe,CACb,MAAO,EAAK,KAAK,eAAe,EAAE,OAChC,CAAC,EAAK,IAAU,OACX,GADW,EAEb,EACE,MAAM,GAAG,EACT,MAAM,CAAC,EACP,KAAK,GAAG,EACR,QAAQ,oBAAqB,EAAE,GAAI,CACxC,GACA,CAAC,CACH,CACF,CACF,CACF,EACA,CACF,EACA,MAAK,GAAU,SACb,GAAU,QAAU,CAAC,GAEvB,EAAU,QAAQ,KAAK,EAAuB,CAAC,EACxC,CACT,CACF,CACF,CAEA,GAAO,GAAQ","names":[]}